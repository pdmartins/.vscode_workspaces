#!/bin/bash
#
# Setup script for the scripts project.
# Initializes git submodules required for Copilot instructions.
# Run this after cloning the repository.
#
# Usage: ./setup.sh

set -e

echo "ğŸš€ Setting up scripts project..."

# Check if git is available
if ! command -v git &> /dev/null; then
    echo "âŒ Git is not installed or not in PATH"
    exit 1
fi

# Initialize and update submodules
echo "ğŸ“¦ Initializing git submodules..."

if git submodule update --init --recursive; then
    echo "âœ… Submodules initialized successfully!"
else
    echo "âš ï¸ Some submodules may have failed. Check if you have access to the repositories."
    echo "   The project will still work, but Copilot custom instructions won't be available."
fi

# Verify submodules
submodules=(
    ".github/.copilot-core"
    ".github/.copilot-project"
)

echo ""
echo "ğŸ“‹ Submodule status:"
for submodule in "${submodules[@]}"; do
    if [ -d "$submodule" ] && [ "$(ls -A "$submodule" 2>/dev/null)" ]; then
        echo "   âœ… $submodule"
    elif [ -d "$submodule" ]; then
        echo "   âš ï¸ $submodule (empty - check access)"
    else
        echo "   âŒ $submodule (not found)"
    fi
done

echo ""
echo "ğŸ‰ Setup complete!"
echo "   Open the project in VS Code to use Copilot with custom instructions."
