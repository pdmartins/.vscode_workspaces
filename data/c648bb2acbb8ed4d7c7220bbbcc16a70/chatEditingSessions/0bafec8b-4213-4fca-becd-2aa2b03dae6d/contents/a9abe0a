---
name: project-setup-bootstrap
description: Configura o projeto via Copilot Chat quando submodules jÃ¡ existem. Preenche context/index.md e subpastas, inicializa memÃ³ria, analisa stack. Inclui modo manual para ambientes com restriÃ§Ãµes. Se submodules nÃ£o existem, orienta a usar project-workspace-create no workspace core. Triggers - configurar projeto, configurar copilot, setup do projeto, bootstrap, inicializar contexto do projeto, configure este projeto, inicializar projeto manualmente, passo a passo.
metadata:
  author: copilot-core
  version: "5.0"
  category: project
  delegable: orchestrated
---

# Project Setup Bootstrap

Configura o projeto via Copilot Chat quando os submodules jÃ¡ existem.

## Fluxo Geral

```
project-workspace-create (workspace core)  â†’  script no projeto-alvo  â†’  project-setup-bootstrap
         â†“                              â†“                          â†“
  cria branch                     pluga submodules            analisa stack
  preenche contexto               cria symlinks               ajusta contexto
  gera script
```

## PrÃ©-condiÃ§Ã£o

Os submodules devem existir em `.copilot-core/` e `.copilot-project/`.

**Se nÃ£o existirem**, orientar o usuÃ¡rio:

1. Abrir o workspace `.copilot-core` + `.copilot-project`
2. No Copilot Chat, dizer: "criar projeto {nome}"
3. O agente vai gerar um script para colar no projeto-alvo

## Quando Usar

- Submodules jÃ¡ existem, mas contexto precisa ser configurado/atualizado
- UsuÃ¡rio diz "configurar projeto", "setup", "bootstrap", "configurar copilot"
- `context/index.md` ainda estÃ¡ com template padrÃ£o

## Workflow

### 1. Verificar submodules

Verificar se `.copilot-core/` e `.copilot-project/` existem.

- **Se nÃ£o existirem:** Orientar a usar `project-workspace-create` no workspace core (ver PrÃ©-condiÃ§Ã£o acima).
- **Se existirem:** Continuar para configuraÃ§Ã£o.

### 2. Analisar o projeto

Identificar automaticamente:

- **Stack tÃ©cnica**: Examinar arquivos como `package.json`, `*.csproj`, `Cargo.toml`, `pyproject.toml`, `go.mod`, `pom.xml`, etc.
- **Frameworks**: React, Next.js, Django, FastAPI, ASP.NET, etc.
- **Ferramentas**: Docker, CI/CD, linters, formatters
- **Estrutura de pastas**: src/, lib/, tests/, etc.

### 3. Coletar informaÃ§Ãµes do usuÃ¡rio

Perguntar de forma conversacional:

1. **Resumo do projeto** â€” "Me descreva brevemente o que este projeto faz"
2. **Fase atual** â€” "Em que fase estÃ¡? (inicial, desenvolvimento, produÃ§Ã£o)"
3. **Algo especÃ­fico** â€” "Alguma restriÃ§Ã£o ou padrÃ£o que devo saber?"

### 4. Preencher context/

Combinar anÃ¡lise automÃ¡tica + respostas do usuÃ¡rio para popular subpastas:

- `context/index.md` â€” Resumo, stack principal, fase
- `context/infrastructure/{slug}.md` â€” Stack detectada (linguagem, framework, DB, infra)
- `context/architecture/{slug}.md` â€” Estrutura do projeto (se detectÃ¡vel)
- `context/conventions/{slug}.md` â€” PadrÃµes e restriÃ§Ãµes do usuÃ¡rio

### 5. Inicializar memÃ³ria

Se `memory/index.md` ainda estÃ¡ com template padrÃ£o, manter como estÃ¡.
Se nÃ£o existe, criar automaticamente a estrutura (ver Auto-Init em `agent-memory-query`).

### 6. Configurar MCP memory-service

#### 6a. Detectar Python e venv

Verificar se o venv jÃ¡ existe em `.copilot-core/.venv/`:

**Windows:**
```powershell
Test-Path .copilot-core/.venv/Scripts/python.exe
```

**Linux/Mac:**
```bash
test -f .copilot-core/.venv/bin/python3
```

- **Se existe** â†’ usar o Python do venv como `{python_path}`
- **Se nÃ£o existe** â†’ reportar: "âš ï¸ Venv nÃ£o encontrado. Execute: `python -m venv .copilot-core/.venv && .copilot-core/.venv/Scripts/pip install mcp-memory-service` (Windows) ou `python3 -m venv .copilot-core/.venv && .copilot-core/.venv/bin/pip install mcp-memory-service` (Linux/Mac)"

#### 6b. Ler config Cloudflare

Ler credenciais de `.copilot-core/.internal/config/credentials.yml`:

```yaml
cloudflare:
  account_id: "..."
  api_token: "..."
  vectorize_index: "..."
  d1_database_id: "..."
mcp:
  storage_backend: "cloudflare"
  server_module: "mcp_memory_service.server"
```

Se o credentials.yml nÃ£o existir â†’ reportar: "âš ï¸ Config Cloudflare ausente. Verificar `.copilot-core/.internal/config/credentials.yml` â€” o ficheiro deve existir no core."

#### 6c. Verificar prÃ©-requisitos

| PrÃ©-requisito | Como verificar | Se ausente |
|---------------|----------------|------------|
| Python 3.12+ | `python --version` ou `python3 --version` | "âš ï¸ Python nÃ£o encontrado. Instale (`winget install Python.Python.3.12` no Windows) e reinicie o VS Code." |
| venv `.copilot-core/.venv/` | Verificar se diretÃ³rio existe | "âš ï¸ Venv nÃ£o encontrado. Execute: `python -m venv .copilot-core/.venv`" |
| mcp-memory-service | `.copilot-core/.venv/Scripts/python -c "import mcp_memory_service"` (Win) ou `.copilot-core/.venv/bin/python3 -c "import mcp_memory_service"` (Linux) | "âš ï¸ Pacote nÃ£o instalado no venv. Execute: `.copilot-core/.venv/Scripts/pip install mcp-memory-service` (Win) ou `.copilot-core/.venv/bin/pip install mcp-memory-service` (Linux)" |

#### 6d. Criar/atualizar mcp.json

**Se `.vscode/mcp.json` nÃ£o existe** â†’ Gerar a partir dos valores do config.yml:

```json
{
  "servers": {
    "memory": {
      "type": "stdio",
      "command": "{python_path}",
      "args": ["-m", "{mcp.server_module}"],
      "env": {
        "MCP_MEMORY_STORAGE_BACKEND": "{mcp.storage_backend}",
        "CLOUDFLARE_API_TOKEN": "{cloudflare.api_token}",
        "CLOUDFLARE_ACCOUNT_ID": "{cloudflare.account_id}",
        "CLOUDFLARE_VECTORIZE_INDEX": "{cloudflare.vectorize_index}",
        "CLOUDFLARE_D1_DATABASE_ID": "{cloudflare.d1_database_id}"
      }
    }
  }
}
```

> `{python_path}`: Caminho completo do Python **do venv**: `.copilot-core/.venv/Scripts/python.exe` (Windows) ou `.copilot-core/.venv/bin/python3` (Linux/Mac). NUNCA usar o Python global do sistema.  
> Os demais `{...}` sÃ£o substituÃ­dos pelos valores reais do config.yml.

**Se jÃ¡ existe** â†’ Verificar se o server "memory" estÃ¡ configurado; se nÃ£o, adicionar.

### 7. Sync inicial MCP

Se `memory/index.md` ou `context/index.md` tÃªm conteÃºdo (nÃ£o sÃ£o template):
â†’ Executar `agent-memory-sync` (full) para popular o Ã­ndice semÃ¢ntico

Se estÃ£o vazios/template:
â†’ Pular (MCP serÃ¡ populado incrementalmente via dual-write)

### 8. Push da branch (se nova)

Se a branch do `.copilot-project` Ã© nova e ainda nÃ£o tem remote:

```bash
cd .copilot-project
git add .
git commit -m "feat: configuraÃ§Ã£o inicial do projeto"
git push -u origin {branch}
```

### 9. Confirmar configuraÃ§Ã£o

**Output:**
```
âœ… Projeto configurado!

ğŸ“‹ Stack detectada: {stack}
ğŸ“ Contexto: .copilot-project/context/index.md
ğŸ§  MemÃ³ria: .copilot-project/memory/index.md
ğŸ” MCP memory: {ativo | nÃ£o configurado (Node.js ausente)}

Agora vocÃª pode:
- Pedir para analisar cÃ³digo
- Registrar liÃ§Ãµes aprendidas
- Criar skills especÃ­ficos para o projeto
```

## DiferenÃ§a dos outros mÃ©todos

| MÃ©todo | Onde roda | PropÃ³sito |
|--------|-----------|----------|
| **project-workspace-create** | Workspace core | Cria branch + contexto + gera script |
| **project-setup-bootstrap** | Projeto-alvo (Chat) | Configura contexto apÃ³s submodules existirem |

## Modo Manual

> Para ambientes com restriÃ§Ãµes especiais ou quando se precisa entender o processo em detalhe.

### PrÃ©-requisitos

- Git inicializado no workspace
- Acesso aos repositÃ³rios `.copilot-core` e `.copilot-project`

### Modos de InstalaÃ§Ã£o

O sistema suporta dois modos de instalaÃ§Ã£o:

| Modo | Quando usar | Visibilidade |
|------|-------------|-------------|
| **Aberto** | Submodules podem ser comitados no repo | `.gitmodules` visÃ­vel, clone recursivo funciona |
| **Stealth** | Submodules NÃƒO podem ser expostos | Tudo no `.gitignore`, setup manual por dev |

### Arquitetura e Scripts de Setup

> ğŸ“‹ **Scripts de setup completos**: ver `.copilot-core/.internal/templates/setup-scripts.md`
>
> ContÃ©m scripts PowerShell + Bash para ambos os modos (aberto e stealth), com variÃ¡veis `{nome-projeto}`, `{repo-core}`, `{repo-project}`.

Para o modo manual, consultar o template acima. Os scripts criam a estrutura:

```
{projeto}/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ instructions/
â”‚       â”œâ”€â”€ agent-skills-core.instructions.md      â†’ symlink
â”‚       â””â”€â”€ agent-skills-project.instructions.md   â†’ symlink
â”œâ”€â”€ .copilot-core/              # Submodule ou clone (branch main)
â””â”€â”€ .copilot-project/           # Submodule ou clone (branch especÃ­fica)
```

## Troubleshooting

### Submodules/clones nÃ£o existem

Orientar o usuÃ¡rio a usar `project-workspace-create` no workspace core (seÃ§Ã£o PrÃ©-condiÃ§Ã£o acima).

### Erro ao fazer push da branch

```bash
cd .copilot-project
git push -u origin {branch}
```

### Contexto jÃ¡ preenchido

Perguntar ao usuÃ¡rio se deseja sobrescrever ou atualizar.

## ReferÃªncia

- Skill de criaÃ§Ã£o: `project-workspace-create`
- DocumentaÃ§Ã£o: `.copilot-core/QUICK-START.md`

## Subagent Pattern

**Tipo**: `orchestrated` â€” pre-collect (3 perguntas â†’ execuÃ§Ã£o)

### Coleta (main agent)

Main agent coleta do usuÃ¡rio:
1. Objetivo principal do projeto
2. PadrÃµes de cÃ³digo a seguir
3. Regras de negÃ³cio mais importantes

TambÃ©m decide: sobrescrever contexto existente? (se aplicÃ¡vel)

### ExecuÃ§Ã£o (subagent)

Subagent recebe respostas e executa:
- Auto-detect de stack (filesystem analysis)
- Preencher context/ (index.md + subpastas)
- Inicializar memÃ³ria
- Push da branch (se instruÃ­do)

### Prompt Exemplo

```
runSubagent({
  description: "Bootstrap project setup",
  prompt: "Leia .copilot-core/skills/project/project-setup-bootstrap/SKILL.md. Respostas do usuÃ¡rio: 1) Objetivo: {objetivo}. 2) PadrÃµes: {padrÃµes}. 3) Regras: {regras}. Sobrescrever contexto existente: {sim/nÃ£o}. Execute o setup completo. Retorne: resumo do que foi configurado."
})
```
