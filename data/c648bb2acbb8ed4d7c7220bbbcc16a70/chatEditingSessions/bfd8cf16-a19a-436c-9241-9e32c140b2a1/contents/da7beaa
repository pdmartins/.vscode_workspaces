---
name: project-codemap-query
description: Consulta o mapa de cÃ³digo do projeto para verificar artefatos existentes antes de implementar. Use SEMPRE antes de criar novas classes, mÃ©todos, funÃ§Ãµes ou componentes para evitar duplicaÃ§Ã£o e maximizar reaproveitamento. Triggers: antes de criar cÃ³digo, antes de implementar feature, "o que jÃ¡ existe", "jÃ¡ tem algo que faz", "quais serviÃ§os existem", "onde fica", "como foi feito", "mostrar estrutura do cÃ³digo".
metadata:
  author: copilot-core
  version: "1.0"
  category: project
---

# Project Codemap Query

Consulta o mapa de cÃ³digo existente para evitar duplicaÃ§Ã£o e identificar oportunidades de reaproveitamento antes de implementar.

## Quando Usar

- **Automaticamente** antes de criar qualquer artefato novo (classe, funÃ§Ã£o, componente, etc.)
- **Automaticamente** antes de alterar artefatos existentes (entender dependÃªncias)
- Quando o usuÃ¡rio perguntar sobre a estrutura do cÃ³digo
- Quando precisar identificar onde colocar nova funcionalidade
- Quando precisar reutilizar cÃ³digo existente

## Workflow

### 1. Carregar Code Map

Ler os arquivos em: `{workspace}/.github/.copilot-project/context/code-map/`

**Ordem de leitura:**
1. `index.md` â€” visÃ£o geral e contagem de artefatos
2. Arquivo(s) relevante(s) para a tarefa (ex: `services.md` se vai criar um serviÃ§o)

**Se diretÃ³rio nÃ£o existe:**
â†’ Criar automaticamente a estrutura do code-map (ver seÃ§Ã£o "Auto-Init" abaixo)
â†’ Depois prosseguir com a consulta

### 2. Analisar antes de implementar

Ao criar novo artefato, verificar:

| VerificaÃ§Ã£o | AÃ§Ã£o |
|-------------|------|
| JÃ¡ existe artefato com mesma responsabilidade? | **Reutilizar** ao invÃ©s de criar novo |
| Existe artefato similar que pode ser estendido? | **Estender** ao invÃ©s de criar novo |
| Existe utilitÃ¡rio que resolve parte do problema? | **Importar e usar** o existente |
| Novo artefato deve depender de qual existente? | **Listar dependÃªncias** corretas |
| HÃ¡ padrÃ£o de nomenclatura nos artefatos existentes? | **Seguir** o mesmo padrÃ£o |

### 3. Reportar ao implementar

**Se encontrou artefato reutilizÃ¡vel:**
```
ğŸ—ºï¸ **Code Map**: Encontrei `{NomeArtefato}` em `{arquivo}` que jÃ¡ faz {descriÃ§Ã£o}. Vou reutilizÃ¡-lo.
```

**Se encontrou artefato similar:**
```
ğŸ—ºï¸ **Code Map**: `{NomeArtefato}` faz algo similar. Posso estendÃª-lo ou criar novo. {recomendaÃ§Ã£o}
```

**Se nÃ£o encontrou nada relevante:**
â†’ Prosseguir com criaÃ§Ã£o e registrar via `code-map-update` apÃ³s implementar

### 4. Responder consultas do usuÃ¡rio

Quando o usuÃ¡rio perguntar sobre a estrutura:

**Output para visÃ£o geral:**
```
ğŸ—ºï¸ **Estrutura do Projeto**:

| MÃ³dulo | Artefatos | DescriÃ§Ã£o |
|--------|-----------|-----------|
| Services | {lista} | {descriÃ§Ã£o} |
| Models | {lista} | {descriÃ§Ã£o} |
...
```

**Output para busca especÃ­fica:**
```
ğŸ—ºï¸ **Artefatos relacionados a "{tema}"**:
- `NomeArtefato` ({tipo}) â€” {responsabilidade} â€” `{arquivo}`
- ...
```

## Checklist PrÃ©-ImplementaÃ§Ã£o

Antes de criar QUALQUER artefato novo, o agente DEVE:

- [ ] Ler `index.md` para visÃ£o geral
- [ ] Ler o arquivo de mapa relevante (services.md, utils.md, etc.)
- [ ] Verificar se jÃ¡ existe algo que resolve o problema
- [ ] Verificar padrÃ£o de nomenclatura dos artefatos existentes
- [ ] Identificar dependÃªncias internas que serÃ£o usadas
- [ ] SÃ³ entÃ£o prosseguir com a implementaÃ§Ã£o

## Auto-Init

Quando `code-map/` ou `index.md` nÃ£o existir, criar automaticamente:

1. Criar diretÃ³rio: `{workspace}/.github/.copilot-project/context/code-map/`
2. Criar `index.md` com template:

```markdown
# Code Map

> Atualizado em: {YYYY-MM-DD}

## Arquitetura

{Analisar o projeto e descrever brevemente a arquitetura em 2-3 linhas}

## MÃ³dulos

| MÃ³dulo | Arquivo do Mapa | DescriÃ§Ã£o | Artefatos |
|--------|-----------------|-----------|-----------|

## DependÃªncias entre MÃ³dulos

{A ser preenchido conforme artefatos sÃ£o registrados}
```

3. Opcionalmente escanear cÃ³digo existente para popular mapas iniciais
4. Informar: `ğŸ—ºï¸ Code Map inicializado automaticamente`
