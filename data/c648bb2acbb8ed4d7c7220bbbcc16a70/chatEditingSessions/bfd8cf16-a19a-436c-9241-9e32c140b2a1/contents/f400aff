---
name: code-review-analyze
description: Analisa cÃ³digo existente identificando problemas de qualidade, seguranÃ§a, performance e aderÃªncia aos padrÃµes do projeto. LÃª config.yml do project para regras e checklist customizado. Triggers: "code review", "revisar cÃ³digo", "analisar qualidade", "review", "PR review", antes de merge, "estÃ¡ bom esse cÃ³digo?", "o que pode melhorar?".
metadata:
  author: copilot-core
  version: "1.0"
  category: code
---

# Code Review Analyze

Analisa cÃ³digo para qualidade, seguranÃ§a, performance e aderÃªncia a padrÃµes.

## Quando Usar

- Code review de PR ou changeset
- AnÃ¡lise de qualidade de cÃ³digo existente
- Antes de merge
- UsuÃ¡rio pergunta "estÃ¡ bom esse cÃ³digo?"

## Config Loading

1. Verificar se existe `{workspace}/.github/.copilot-project/skills/code-review-analyze/config.yml`
2. Se existe, carregar regras e checklist do projeto
3. Verificar se existe `{workspace}/.github/.copilot-project/skills/code-review-analyze/SKILL.md`
4. Se existe, carregar instruÃ§Ãµes complementares
5. Se nenhum existe, usar padrÃµes genÃ©ricos

## Workflow

### 1. Identificar escopo

- Quais arquivos/mÃ©todos analisar
- Contexto do changeset (propÃ³sito da mudanÃ§a)

### 2. Carregar padrÃµes do projeto

- Ler config.yml para regras especÃ­ficas
- Consultar `project-context-query` para stack e restriÃ§Ãµes
- Consultar `project-codemap-query` para entender dependÃªncias

### 3. Analisar por categoria

| Categoria | O que verificar |
|-----------|----------------|
| **CorreÃ§Ã£o** | LÃ³gica correta, edge cases, null handling |
| **SeguranÃ§a** | Injection, auth bypass, secrets expostos, OWASP |
| **Performance** | N+1 queries, alocaÃ§Ãµes desnecessÃ¡rias, async/await |
| **ManutenÃ§Ã£o** | Naming, SRP, DRY, complexidade ciclomÃ¡tica |
| **Testes** | Cobertura dos cenÃ¡rios, mocks corretos |
| **PadrÃµes** | AderÃªncia Ã s convenÃ§Ãµes do projeto (conforme config) |

### 4. Classificar severidade

| Severidade | Quando usar |
|------------|-------------|
| ğŸ”´ **CrÃ­tico** | Bug, seguranÃ§a, data loss |
| ğŸŸ  **Alto** | Performance, violaÃ§Ã£o de padrÃ£o obrigatÃ³rio |
| ğŸŸ¡ **MÃ©dio** | ManutenÃ§Ã£o, naming, DRY |
| ğŸ”µ **Baixo** | Estilo, sugestÃµes de melhoria |

### 5. Apresentar resultados

```
ğŸ“ **Code Review**

ğŸ”´ **CrÃ­tico** (X issues)
- [arquivo:linha] DescriÃ§Ã£o do problema â†’ SugestÃ£o

ğŸŸ  **Alto** (X issues)
- [arquivo:linha] DescriÃ§Ã£o â†’ SugestÃ£o

ğŸŸ¡ **MÃ©dio** (X issues)
- [arquivo:linha] DescriÃ§Ã£o â†’ SugestÃ£o

ğŸ”µ **Baixo** (X issues)
- [arquivo:linha] DescriÃ§Ã£o â†’ SugestÃ£o

âœ… **Pontos positivos**
- Bom uso de X
- PadrÃ£o Y bem aplicado
```

## Checklist

- [ ] LÃ³gica correta e edge cases cobertos
- [ ] Sem vulnerabilidades de seguranÃ§a
- [ ] Performance adequada
- [ ] Naming e organizaÃ§Ã£o seguem padrÃµes
- [ ] Testes acompanham as mudanÃ§as
- [ ] CancellationToken propagado (se async)
- [ ] Logging adequado

## Config Schema

```yaml
# .copilot-project/skills/code-review-analyze/config.yml
severity-levels: [critical, high, medium, low]
categories:
  - correctness
  - security
  - performance
  - maintainability
  - testing
  - patterns
rules:
  require-cancellation-token: true
  require-null-guards: true
  require-logging: true
  max-method-lines: 30
  max-class-lines: 300
  max-parameters: 5
checklist:
  - "Null guards em parÃ¢metros do construtor"
  - "CancellationToken em mÃ©todos async"
  - "Structured logging"
  - "Error handling adequado"
ignore:
  files: ["*.generated.cs", "Migrations/*"]
  rules: []
```
