# Project Context â€” Copilot Core

Estado atual do projeto para referÃªncia do Copilot.

---

## Objetivo

Sistema de instruÃ§Ãµes e skills reutilizÃ¡veis para o Copilot Agent, seguindo o padrÃ£o [Agent Skills](https://agentskills.io). Fornece um core genÃ©rico (`.copilot-core`) que Ã© plugado via git submodule ou clone na **raiz** de qualquer projeto, junto com um repositÃ³rio de dados por projeto (`.copilot-project`) com branch por projeto. Suporta dois modos de instalaÃ§Ã£o: **aberto** (submodule visÃ­vel) e **stealth** (clone + gitignore, invisÃ­vel).

## Repos

| Repo | URL | PropÃ³sito |
|------|-----|-----------|
| `.copilot-core` | `https://github.com/pdmartins/.copilot-core.git` | Skills genÃ©ricos, instruÃ§Ãµes globais, templates |
| `.copilot-project` | `https://github.com/pdmartins/.copilot-project.git` | Contexto, memÃ³ria e skills especÃ­ficos por projeto (branch por projeto) |

## Stack

| Componente | Tecnologia |
|------------|------------|
| Formato | Markdown (Agent Skills pattern) |
| Versionamento | Git (submodules ou clones para distribuiÃ§Ã£o) |
| PadrÃ£o | [Agent Skills](https://agentskills.io) |
| Commit | Conventional Commits |
| Linting | markdownlint (via extensÃ£o VS Code) |

## Arquitetura

**Workspace de desenvolvimento** com dois repos lado a lado, seguindo o padrÃ£o standard de projetos consumidores:

```
copilot/                          # Pasta raiz do workspace
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ instructions/
â”‚       â”œâ”€â”€ default.instructions.md      â†’ symlink â†’ ../../.copilot-core/instructions/default.instructions.md
â”‚       â””â”€â”€ workspace.instructions.md    â†’ symlink â†’ ../../.copilot-project/instructions/workspace.instructions.md
â”‚
â”œâ”€â”€ .copilot-core/                # Repo principal (branch main)
â”‚   â”œâ”€â”€ .source-control/
â”‚   â”‚   â””â”€â”€ commit-prompt.md
â”‚   â”œâ”€â”€ instructions/
â”‚   â”‚   â””â”€â”€ default.instructions.md
â”‚   â”œâ”€â”€ skills/                   # Skills organizados por tipo
â”‚   â”‚   â”œâ”€â”€ agent/
â”‚   â”‚   â”œâ”€â”€ code/
â”‚   â”‚   â”œâ”€â”€ editor/
â”‚   â”‚   â”œâ”€â”€ infra/
â”‚   â”‚   â”œâ”€â”€ project/
â”‚   â”‚   â””â”€â”€ skill/
â”‚   â”‚       â””â”€â”€ {skill-name}/SKILL.md
â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â””â”€â”€ workspace.instructions.md
â”‚   â””â”€â”€ QUICK-START.md
â”‚
â”œâ”€â”€ .copilot-project/             # Repo auxiliar â€” branch: _pm/copilot-core
â”‚   â”œâ”€â”€ context/
â”‚   â”‚   â””â”€â”€ project.md
â”‚   â”œâ”€â”€ instructions/
â”‚   â”‚   â””â”€â”€ workspace.instructions.md
â”‚   â”œâ”€â”€ memory/
â”‚   â”‚   â””â”€â”€ lessons-learned.md
â”‚   â””â”€â”€ skills/
â”‚
â””â”€â”€ .copilot-project-worktrees/   # Worktrees do .copilot-project (nomes = branches)
    â”œâ”€â”€ main/
    â”œâ”€â”€ _bw/bewiser.assistant.api/
    â”œâ”€â”€ _hv/STT/
    â”œâ”€â”€ _pm/docker-framework/
    â”œâ”€â”€ _pm/everyday_queries/
    â””â”€â”€ _pm/scripts/
```

### EstratÃ©gia de Branches

#### `.copilot-core`

- Branch Ãºnica: `main` (fonte de verdade e distribuiÃ§Ã£o)
- Projetos consumidores usam `main` (via submodule ou clone)

#### `.copilot-project`

| Branch | PropÃ³sito |
|--------|-----------|
| `main` | Template base agnÃ³stico |
| `_pm/copilot-core` | Dados deste projeto (workspace de desenvolvimento do core) |
| `{nome-projeto}` | Dados especÃ­ficos de cada projeto plugado |

### Projetos Consumidores

Nos projetos-alvo, a estrutura final Ã©:

```
{projeto}/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ instructions/
â”‚       â”œâ”€â”€ default.instructions.md      â†’ symlink â†’ ../../.copilot-core/instructions/default.instructions.md
â”‚       â””â”€â”€ workspace.instructions.md    â†’ symlink â†’ ../../.copilot-project/instructions/workspace.instructions.md
â”‚
â”œâ”€â”€ .copilot-core/                  # Submodule ou clone (branch main)
â””â”€â”€ .copilot-project/               # Submodule ou clone (branch do projeto)
    â””â”€â”€ instructions/
        â””â”€â”€ workspace.instructions.md   # Arquivo real especÃ­fico do projeto
```

**Modo aberto** (submodule): visÃ­vel no `.gitmodules`, onboarding via `git clone --recursive`.
**Modo stealth** (clone): `.copilot-core/`, `.copilot-project/` e symlinks no `.gitignore`, onboarding via script manual.

Os arquivos em `.github/instructions/` sÃ£o **symlinks**, nunca cÃ³pias. Isso garante sincronizaÃ§Ã£o automÃ¡tica com os repos de origem.

## Skills Core (56)

| Tipo | Skill | PropÃ³sito |
|------|-------|-----------|
| agent | `agent-catalog-query` | **CatÃ¡logo** â€” Ã­ndice de skills agent |
| agent | `agent-memory-query` | Consultar liÃ§Ãµes aprendidas |
| agent | `agent-memory-register` | Registrar novas liÃ§Ãµes |
| agent | `agent-task-manage` | Gerenciar tarefas complexas |
| agent | `agent-subagent-delegate` | Regras de delegaÃ§Ã£o a subagents |
| agent | `agent-chat-save` | Salvar sessÃ£o de chat para retomada cross-machine |
| agent | `agent-chat-resume` | Retomar sessÃ£o de chat anterior |
| agent | `agent-action-review` | Validar completude e consistÃªncia pÃ³s-aÃ§Ã£o |
| code | `code-catalog-query` | **CatÃ¡logo** â€” Ã­ndice de skills code |
| code | `code-review-analyze` | AnÃ¡lise de qualidade, seguranÃ§a e performance |
| code | `code-refactor-extract` | ExtraÃ§Ã£o de mÃ©todos/classes, SRP |
| code | `code-pattern-enforce` | VerificaÃ§Ã£o e enforcement de padrÃµes |
| code | `code-dotnet-service` | GeraÃ§Ã£o de serviÃ§os/handlers .NET |
| code | `code-dotnet-test` | GeraÃ§Ã£o de testes unitÃ¡rios .NET |
| code | `code-bash-write` | PadrÃµes para scripts Bash |
| code | `code-powershell-write` | PadrÃµes para scripts PowerShell |
| code | `code-crossplatform-sync` | SincronizaÃ§Ã£o Bash â†” PowerShell |
| code | `code-api-validate` | ValidaÃ§Ã£o de aderÃªncia a padrÃµes de API |
| code | `code-command-generate` | Commands MediatR / CQRS |
| code | `code-contracts-generate` | Requests/Responses de API |
| code | `code-controller-generate` | Controllers RESTful |
| code | `code-entity-generate` | Entities e Aggregates DDD |
| code | `code-event-generate` | Domain Events |
| code | `code-integrationtest-generate` | Testes de integraÃ§Ã£o |
| code | `code-mapping-generate` | DTOs e Mapping Extensions |
| code | `code-program-configure` | Clean Program.cs / DI |
| code | `code-query-generate` | Queries MediatR / CQRS |
| code | `code-unittest-generate` | Testes unitÃ¡rios (xUnit, builders) |
| code | `code-valueobject-generate` | Value Objects imutÃ¡veis DDD |
| code | `code-webhook-generate` | Webhooks e integraÃ§Ãµes callback |
| project | `project-context-query` | Consultar contexto do projeto |
| project | `project-context-update` | Atualizar contexto |
| project | `project-codemap-query` | Consultar mapa de cÃ³digo |
| project | `project-codemap-update` | Registrar/atualizar artefatos |
| project | `project-structure-analyze` | Analisar projeto e sugerir skills |
| project | `project-workspace-create` | Criar projeto completo (Plan mode) |
| project | `project-setup-bootstrap` | Configurar projeto (automÃ¡tico + manual) |
| project | `project-repo-update` | Atualizar repos core e project |
| project | `project-branch-switch` | Trocar branch do .copilot-project |
| project | `project-catalog-query` | **CatÃ¡logo** â€” Ã­ndice de skills project |
| skill | `skill-template-create` | Criar novos skills |
| skill | `skill-output-validate` | Validar estrutura e qualidade de artefatos de metadata |
| editor | `editor-markdown-lint` | Regras de formataÃ§Ã£o Markdown |
| editor | `editor-readme-generate` | CriaÃ§Ã£o e atualizaÃ§Ã£o de READMEs |
| infra | `infra-catalog-query` | **CatÃ¡logo** â€” Ã­ndice de skills infra |
| infra | `infra-docker-build` | GeraÃ§Ã£o de Dockerfile multi-stage |
| infra | `infra-redis-cache` | PadrÃ£o cache-aside com Redis |
| infra | `infra-bigquery-query` | Queries BigQuery parametrizadas |
| infra | `infra-gcp-integrate` | IntegraÃ§Ã£o com serviÃ§os GCP |
| infra | `infra-k8s-deploy` | Manifests Kubernetes |
| infra | `infra-pipeline-deploy` | Pipelines CI/CD |
| infra | `infra-vertexai-prompt` | GestÃ£o de prompts Vertex AI |
| infra | `infra-jwt-configure` | AutenticaÃ§Ã£o JWT |
| infra | `infra-messaging-configure` | Mensageria (MassTransit, Service Bus) |
| infra | `infra-repository-generate` | Repositories (Dapper + SQL) |
| infra | `infra-service-integrate` | IntegraÃ§Ã£o com serviÃ§os externos |

### PadrÃµes dos Skills

- **Naming**: `{tipo}-{feature}-{aÃ§Ã£o}` â€” sempre 3 segmentos, kebab-case
- **Tipos**: `agent`, `code`, `project`, `skill`, `editor`, `infra`
- **category = tipo**: Primeiro segmento do nome no frontmatter
- **Estrutura**: `skills/{tipo}/{name}/SKILL.md` (organizados em subpastas por tipo)
- **Config pattern**: Skills `infra` e `code` carregam `config.yml` do project
- **Frontmatter**: YAML com `name`, `description`, `metadata` (`author`, `version`, `category`)
- **SeÃ§Ãµes**: `## Quando Usar` â†’ `## Workflow` com steps numerados
- **Output**: ConfirmaÃ§Ãµes com emojis (`âœ…`, `ğŸ“`, `ğŸ“š`, `ğŸ”„`, `ğŸ—ºï¸`, `ğŸ“‹`)
- **Auto-Init**: Skills de query/update inicializam estrutura automaticamente se nÃ£o existe
- **Core = lÃ³gica**: Regras genÃ©ricas ficam no core
- **Project = config**: Dados especÃ­ficos ficam em `config.yml` no project

## ConvenÃ§Ãµes

1. **PortuguÃªs para chat, inglÃªs para cÃ³digo**: VariÃ¡veis, nomes de arquivo, paths em inglÃªs
2. **Core Ã© genÃ©rico**: Nunca referenciar projetos especÃ­ficos nos skills core
3. **Responsabilidade Ãºnica**: Cada skill faz UMA coisa
4. **Conventional Commits**: `<type>(<scope>): <description>` (single-line, â‰¤250 chars)
5. **Instructions via symlink**: Arquivos em `.github/instructions/` sÃ£o sempre symlinks, nunca cÃ³pias
6. **Worktrees**: `.copilot-project` usa git worktrees em `.copilot-project-worktrees/` com nomes espelhando exatamente os nomes das branches

## Estado Atual

**Fase**: Ativo
**Status**: Core estÃ¡vel com 56 skills organizados em subpastas por tipo (nomenclatura `{tipo}-{feature}-{aÃ§Ã£o}`), sistema em uso em projetos reais. Suporte a dual-mode (aberto/stealth) para instalaÃ§Ã£o em projetos. Projetos estendem core via `config.yml` (dados estruturados) + `SKILL.md` opcional (extensÃµes provider-specific).

## Projetos Plugados

| Branch (.copilot-project) | Projeto | Status |
|---------------------------|---------|--------|
| `main` | Template base | â€” |
| `_pm/copilot-core` | Workspace de desenvolvimento do core | Ativo |
| `_bw/bewiser.assistant.api` | BeWiser Assistant API | Ativo |
| `_hv/STT` | VoiceTranscription.AI (Hapvida) | Ativo |
| `_pm/docker-framework` | Docker Framework | â€” |
| `_pm/everyday_queries` | Everyday Queries | Ativo |
| `_pm/scripts` | Scripts de automaÃ§Ã£o | Ativo |

## InconsistÃªncias Conhecidas

| # | Issue | Local | Detalhe |
|---|-------|-------|---------|
| 1 | URLs hardcoded | `project-workspace-create` | `github.com/pdmartins/` nÃ£o parametrizado |

## Regras deste Workspace

1. **Branch ativa**: `.copilot-project/` deve sempre ter a branch `_pm/copilot-core` ativa (checkout direto)
2. **main como worktree**: A branch `main` (template) deve sempre existir como worktree em `.copilot-project-worktrees/main/`
3. **Naming de branches**: Branches de projetos pessoais usam prefixo `_pm/`, orgs usam `_{org}/`

## Ãšltima AtualizaÃ§Ã£o

**Data**: 2026-02-16
**Motivo**: ValidaÃ§Ã£o profunda e correÃ§Ãµes â€” contagens atualizadas (56 skills), referÃªncias quebradas corrigidas, template alinhado com 4 colunas (Delegable), code-map criado, catÃ¡logo unificado de project skills introduzido, README atualizado
