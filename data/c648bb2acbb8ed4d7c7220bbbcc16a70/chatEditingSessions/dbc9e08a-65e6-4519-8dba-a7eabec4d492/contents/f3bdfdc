# Project Context ‚Äî Copilot Core

Estado atual do projeto para refer√™ncia do Copilot.

---

## Objetivo

Sistema de instru√ß√µes e skills reutiliz√°veis para o Copilot Agent, seguindo o padr√£o [Agent Skills](https://agentskills.io). Fornece um core gen√©rico (`.copilot-core`) que √© plugado via git submodule ou clone na **raiz** de qualquer projeto, junto com um reposit√≥rio de dados por projeto (`.copilot-project`) com branch por projeto. Suporta dois modos de instala√ß√£o: **aberto** (submodule vis√≠vel) e **stealth** (clone + gitignore, invis√≠vel).

## Repos

| Repo | URL | Prop√≥sito |
|------|-----|-----------|
| `.copilot-core` | `https://github.com/pdmartins/.copilot-core.git` | Skills gen√©ricos, instru√ß√µes globais, templates |
| `.copilot-project` | `https://github.com/pdmartins/.copilot-project.git` | Contexto, mem√≥ria e skills espec√≠ficos por projeto (branch por projeto) |

## Stack

| Componente | Tecnologia |
|------------|------------|
| Formato | Markdown (Agent Skills pattern) |
| Versionamento | Git (submodules ou clones para distribui√ß√£o) |
| Padr√£o | [Agent Skills](https://agentskills.io) |
| Commit | Conventional Commits |
| Linting | markdownlint (via extens√£o VS Code) |

## Arquitetura

> Ver `workspace.instructions.md` para diagrama completo da arquitetura do sistema.

**Workspace de desenvolvimento** com dois repos lado a lado, seguindo o padr√£o standard de projetos consumidores.

### Estrat√©gia de Branches

#### `.copilot-core`

- Branch √∫nica: `main` (fonte de verdade e distribui√ß√£o)
- Projetos consumidores usam `main` (via submodule ou clone)

#### `.copilot-project`

| Branch | Prop√≥sito |
|--------|-----------|
| `main` | Template base agn√≥stico |
| `_pm/copilot-core` | Dados deste projeto (workspace de desenvolvimento do core) |
| `{nome-projeto}` | Dados espec√≠ficos de cada projeto plugado |

### Projetos Consumidores

Nos projetos-alvo, a estrutura final √©:

```
{projeto}/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ instructions/
‚îÇ       ‚îú‚îÄ‚îÄ default.instructions.md      ‚Üí symlink ‚Üí ../../.copilot-core/instructions/default.instructions.md
‚îÇ       ‚îî‚îÄ‚îÄ workspace.instructions.md    ‚Üí symlink ‚Üí ../../.copilot-project/instructions/workspace.instructions.md
‚îÇ
‚îú‚îÄ‚îÄ .copilot-core/                  # Submodule ou clone (branch main)
‚îî‚îÄ‚îÄ .copilot-project/               # Submodule ou clone (branch do projeto)
    ‚îî‚îÄ‚îÄ instructions/
        ‚îî‚îÄ‚îÄ workspace.instructions.md   # Arquivo real espec√≠fico do projeto
```

**Modo aberto** (submodule): vis√≠vel no `.gitmodules`, onboarding via `git clone --recursive`.
**Modo stealth** (clone): `.copilot-core/`, `.copilot-project/` e symlinks no `.gitignore`, onboarding via script manual.

Os arquivos em `.github/instructions/` s√£o **symlinks**, nunca c√≥pias. Isso garante sincroniza√ß√£o autom√°tica com os repos de origem.

## Skills Core (56)

| Tipo | Skill | Prop√≥sito |
|------|-------|-----------|
| agent | `agent-catalog-query` | **Cat√°logo** ‚Äî √≠ndice de skills agent |
| agent | `agent-memory-query` | Consultar li√ß√µes aprendidas |
| agent | `agent-memory-register` | Registrar novas li√ß√µes |
| agent | `agent-task-manage` | Gerenciar tarefas complexas |
| agent | `agent-subagent-delegate` | Regras de delega√ß√£o a subagents |
| agent | `agent-chat-save` | Salvar sess√£o de chat para retomada cross-machine |
| agent | `agent-chat-resume` | Retomar sess√£o de chat anterior |
| agent | `agent-action-review` | Validar completude e consist√™ncia p√≥s-a√ß√£o |
| code | `code-catalog-query` | **Cat√°logo** ‚Äî √≠ndice de skills code |
| code | `code-review-analyze` | An√°lise de qualidade, seguran√ßa e performance |
| code | `code-refactor-extract` | Extra√ß√£o de m√©todos/classes, SRP |
| code | `code-pattern-enforce` | Verifica√ß√£o e enforcement de padr√µes |
| code | `code-dotnet-service` | Gera√ß√£o de servi√ßos/handlers .NET |
| code | `code-dotnet-test` | Gera√ß√£o de testes unit√°rios .NET |
| code | `code-bash-write` | Padr√µes para scripts Bash |
| code | `code-powershell-write` | Padr√µes para scripts PowerShell |
| code | `code-crossplatform-sync` | Sincroniza√ß√£o Bash ‚Üî PowerShell |
| code | `code-api-validate` | Valida√ß√£o de ader√™ncia a padr√µes de API |
| code | `code-command-generate` | Commands MediatR / CQRS |
| code | `code-contracts-generate` | Requests/Responses de API |
| code | `code-controller-generate` | Controllers RESTful |
| code | `code-entity-generate` | Entities e Aggregates DDD |
| code | `code-event-generate` | Domain Events |
| code | `code-integrationtest-generate` | Testes de integra√ß√£o |
| code | `code-mapping-generate` | DTOs e Mapping Extensions |
| code | `code-program-configure` | Clean Program.cs / DI |
| code | `code-query-generate` | Queries MediatR / CQRS |
| code | `code-unittest-generate` | Testes unit√°rios (xUnit, builders) |
| code | `code-valueobject-generate` | Value Objects imut√°veis DDD |
| code | `code-webhook-generate` | Webhooks e integra√ß√µes callback |
| project | `project-context-query` | Consultar contexto do projeto |
| project | `project-context-update` | Atualizar contexto |
| project | `project-codemap-query` | Consultar mapa de c√≥digo |
| project | `project-codemap-update` | Registrar/atualizar artefatos |
| project | `project-structure-analyze` | Analisar projeto e sugerir skills |
| project | `project-workspace-create` | Criar projeto completo (Plan mode) |
| project | `project-setup-bootstrap` | Configurar projeto (autom√°tico + manual) |
| project | `project-repo-update` | Atualizar repos core e project |
| project | `project-branch-switch` | Trocar branch do .copilot-project |
| project | `project-catalog-query` | **Cat√°logo** ‚Äî √≠ndice de skills project |
| skill | `skill-template-create` | Criar novos skills |
| skill | `skill-output-validate` | Validar estrutura e qualidade de artefatos de metadata |
| editor | `editor-markdown-lint` | Regras de formata√ß√£o Markdown |
| editor | `editor-readme-generate` | Cria√ß√£o e atualiza√ß√£o de READMEs |
| infra | `infra-catalog-query` | **Cat√°logo** ‚Äî √≠ndice de skills infra |
| infra | `infra-docker-build` | Gera√ß√£o de Dockerfile multi-stage |
| infra | `infra-redis-cache` | Padr√£o cache-aside com Redis |
| infra | `infra-bigquery-query` | Queries BigQuery parametrizadas |
| infra | `infra-gcp-integrate` | Integra√ß√£o com servi√ßos GCP |
| infra | `infra-k8s-deploy` | Manifests Kubernetes |
| infra | `infra-pipeline-deploy` | Pipelines CI/CD |
| infra | `infra-vertexai-prompt` | Gest√£o de prompts Vertex AI |
| infra | `infra-jwt-configure` | Autentica√ß√£o JWT |
| infra | `infra-messaging-configure` | Mensageria (MassTransit, Service Bus) |
| infra | `infra-repository-generate` | Repositories (Dapper + SQL) |
| infra | `infra-service-integrate` | Integra√ß√£o com servi√ßos externos |

### Padr√µes dos Skills

- **Naming**: `{tipo}-{feature}-{a√ß√£o}` ‚Äî sempre 3 segmentos, kebab-case
- **Tipos**: `agent`, `code`, `project`, `skill`, `editor`, `infra`
- **category = tipo**: Primeiro segmento do nome no frontmatter
- **Estrutura**: `skills/{tipo}/{name}/SKILL.md` (organizados em subpastas por tipo)
- **Config pattern**: Skills `infra` e `code` carregam `config.yml` do project
- **Frontmatter**: YAML com `name`, `description`, `metadata` (`author`, `version`, `category`)
- **Se√ß√µes**: `## Quando Usar` ‚Üí `## Workflow` com steps numerados
- **Output**: Confirma√ß√µes com emojis (`‚úÖ`, `üìù`, `üìö`, `üîÑ`, `üó∫Ô∏è`, `üìã`)
- **Auto-Init**: Skills de query/update inicializam estrutura automaticamente se n√£o existe
- **Core = l√≥gica**: Regras gen√©ricas ficam no core
- **Project = config**: Dados espec√≠ficos ficam em `config.yml` no project

## Conven√ß√µes

1. **Portugu√™s para chat, ingl√™s para c√≥digo**: Vari√°veis, nomes de arquivo, paths em ingl√™s
2. **Core √© gen√©rico**: Nunca referenciar projetos espec√≠ficos nos skills core
3. **Responsabilidade √∫nica**: Cada skill faz UMA coisa
4. **Conventional Commits**: `<type>(<scope>): <description>` (single-line, ‚â§250 chars)
5. **Instructions via symlink**: Arquivos em `.github/instructions/` s√£o sempre symlinks, nunca c√≥pias
6. **Worktrees**: `.copilot-project` usa git worktrees em `.copilot-project-worktrees/` com nomes espelhando exatamente os nomes das branches

## Estado Atual

**Fase**: Ativo
**Status**: Core est√°vel com 56 skills organizados em subpastas por tipo (nomenclatura `{tipo}-{feature}-{a√ß√£o}`), sistema em uso em projetos reais. Suporte a dual-mode (aberto/stealth) para instala√ß√£o em projetos. Projetos estendem core via `config.yml` (dados estruturados) + `SKILL.md` opcional (extens√µes provider-specific).

## Projetos Plugados

| Branch (.copilot-project) | Projeto | Status |
|---------------------------|---------|--------|
| `main` | Template base | ‚Äî |
| `_pm/copilot-core` | Workspace de desenvolvimento do core | Ativo |
| `_bw/bewiser.assistant.api` | BeWiser Assistant API | Ativo |
| `_hv/STT` | VoiceTranscription.AI (Hapvida) | Ativo |
| `_pm/docker-framework` | Docker Framework | ‚Äî |
| `_pm/everyday_queries` | Everyday Queries | Ativo |
| `_pm/scripts` | Scripts de automa√ß√£o | Ativo |

## Inconsist√™ncias Conhecidas

| # | Issue | Local | Detalhe |
|---|-------|-------|---------|
| 1 | URLs hardcoded | `project-workspace-create` | `github.com/pdmartins/` n√£o parametrizado |

## Regras deste Workspace

1. **Branch ativa**: `.copilot-project/` deve sempre ter a branch `_pm/copilot-core` ativa (checkout direto)
2. **main como worktree**: A branch `main` (template) deve sempre existir como worktree em `.copilot-project-worktrees/main/`
3. **Naming de branches**: Branches de projetos pessoais usam prefixo `_pm/`, orgs usam `_{org}/`

## √öltima Atualiza√ß√£o

**Data**: 2026-02-16
**Motivo**: Valida√ß√£o profunda e corre√ß√µes ‚Äî contagens atualizadas (56 skills), refer√™ncias quebradas corrigidas, template alinhado com 4 colunas (Delegable), code-map criado, cat√°logo unificado de project skills introduzido, README atualizado
